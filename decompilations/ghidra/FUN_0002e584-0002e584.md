```c
void LogMessageWithTimestamp(LogLevel logLevel, char *message, undefined4 param_3)
{
  FILE *logFile;
  struct tm *timeInfo;
  int milliSeconds;
  size_t stringSize;
  byte shouldLogToTerminal;
  uint currentTimestampSeconds;
  uint currentTimestampMicroSeconds;
  uint timestampInSeconds;
  char timestampedMessageBuffer[64];
  
  uint loggingFlag = (uint)globalLoggingFlag;
  if (loggingFlag == 0) {
    timestampInSeconds = loggingFlag;
    GetTimestamp(&currentTimestampSeconds);
    currentTimestampMicroSeconds = currentTimestampSeconds;
    milliSeconds = (int)timestampInSeconds / 1000;
    timeInfo = localtime((time_t *)&currentTimestampMicroSeconds);
    snprintf(timestampedMessageBuffer, sizeof(timestampedMessageBuffer), 
             " [%d-%02d-%02d %02d:%02d:%02d.%03d] ",
             timeInfo->tm_year + 1900, timeInfo->tm_mon + 1, timeInfo->tm_mday, 
             timeInfo->tm_hour, timeInfo->tm_min, timeInfo->tm_sec, milliSeconds);
    
    int fd = fileno(stderr);
    int isTty = isatty(fd);
    if (isTty == 0) {
      fprintf(stderr, "%s%s\n", timestampedMessageBuffer, message);
      fflush(stderr);
    }

    if ((globalLoggingToFile != '\0') &&
        ((globalLogFilePointer != NULL ||
          (globalLogFilePointer = fopen64(globalLogFilePath, "a"), globalLogFilePointer != NULL)))) {
      logFile = globalLogFilePointer;
      stringSize = strlen(timestampedMessageBuffer);
      fwrite(timestampedMessageBuffer, stringSize, 1, logFile);
      stringSize = strlen(message);
      fwrite(message, stringSize, 1, globalLogFilePointer);
      fwrite("\n", 1, 1, globalLogFilePointer);
      fflush(globalLogFilePointer);
    }
    
    if (globalLogIdentifier == 0) {
      globalLogIdentifier = InitializeSyslog("bmminer_miner");
    }
    
    SendToSyslog(globalLogIdentifier, "logging.c", 9, "_applog", 7, LOG_INFO, DEBUG_LEVEL, "%s", message);
    
    if (logLevel == LogLevelCritical) {
      shouldLogToTerminal = 0;
    }
    else {
      shouldLogToTerminal = globalLoggingToTerminal & 1;
    }
    
    if (shouldLogToTerminal == 0) {
      LogToFileOrSyslog(timestampedMessageBuffer, message, param_3);
      return;
    }
  }
  else {
    syslog(logLevel | LOG_PID, "%s", message);
    if (globalLogIdentifier == 0) {
      globalLogIdentifier = InitializeSyslog("bmminer_miner");
    }
    SendToSyslog(globalLogIdentifier, "logging.c", 9, "_applog", 7, LOG_WARNING, DEBUG_LEVEL, "%s", message);
  }
  
  return;
}
```