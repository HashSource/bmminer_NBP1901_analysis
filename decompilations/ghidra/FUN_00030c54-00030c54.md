```c
#include <semaphore.h>
#include <time.h>

// Define customized function name for error logging
void LogErrorWithLocation(int logLevel, const char *message, int exitProgram);

// Define customized function to initialize timespec structure based on given microseconds
void InitializeTimeSpec(timespec *timeSpec, long microsec);

// Define the custom function to safely handle integer to string conversion and log the message
void SafeSnprintfAndLog(char *buffer, size_t bufSize, const char *format, ...);

// Semaphore timed-wait with logging
// Attempts to acquire the semaphore with a timeout, logs failure, and retries if interrupted
// Returns:
//   0 on success
//   ETIMEDOUT (110) if the wait times out
unsigned int SemaphoreTimedWaitWithLogging(sem_t *semaphore, int timeoutMs, unsigned int loggingVar1, unsigned int loggingVar2, unsigned int loggingVar3)
{
  int *errorNumberPtr;
  int waitResult;
  int errorCode;
  timespec currentTime;
  timespec waitTime;
  
  // Get current time
  clock_gettime(CLOCK_MONOTONIC, &currentTime);
  
  // Calculate absolute time for wait timeout
  InitializeTimeSpec(&waitTime, currentTime.tv_nsec / 1000, timeoutMs);
  do {
    // Calculate waitTime by adding current time and timeout
    waitTime.tv_nsec = (currentTime.tv_nsec / 1000) * 1000 + waitTime.tv_nsec;
    waitTime.tv_sec += currentTime.tv_sec;
    
    // Normalize timespec if needed
    if (waitTime.tv_nsec >= 1000000000) {
      waitTime.tv_nsec -= 1000000000;
      waitTime.tv_sec++;
    }
    while (waitTime.tv_nsec < 0) {
      waitTime.tv_nsec += 1000000000;
      waitTime.tv_sec--;
    }
    
    // Wait for semaphore or timeout
    waitResult = sem_timedwait(semaphore, &waitTime);
    if (waitResult == 0) {
      return 0; // Success
    }
    
    // Retrieve error code
    errorNumberPtr = __errno_location();
    errorCode = *errorNumberPtr;
    
    if (errorCode == ETIMEDOUT) {
      return ETIMEDOUT; // Timeout reached
    }
  } while (errorCode == EINTR); // Retry if interrupted by a signal
  
  // On failure, log error and exit if necessary
  char logBuffer[2048]; // Buffer for log message
  SafeSnprintfAndLog(logBuffer, 2048, "Failed to sem_timedwait errno=%d semaphore=0x%p in %u %u():%u", errorCode, semaphore, loggingVar1, loggingVar2, loggingVar3);
  LogErrorWithLocation(3, logBuffer, 1); // Log with level 3 and exit

  return 0; // Should not reach here because LogErrorWithLocation exits the program
}
```