```c
void UpdateFanSpeed(void)
{
  int minPicTemp;
  int maxPicTemp;
  undefined4 maxChipTemp;
  int latestMinPicTemp;
  uint tempDifference;
  uint lastDiffContinuousTime;
  int currentMinPicTempDifference;
  bool tempIncreaseDetected;
  bool tempIncreaseFlag;
  float tempProportion;
  char logBuffer[2052]; // Buffer for log messages
  
  // Check if manual fan speed is set and within range
  if ((((byte)manualFanControlFlag & 2) != 0) && (manualFanSpeed < 0x65)) {
    // Force fan speed set in manual mode
    ForceFanSpeed();
    if (fanSpeedSet != 0) {
      return;
    }
    if (debugLevel > 3) {
      snprintf(logBuffer, 0x800, "fan_etf: Set fixed fan speed=%d\n", (uint)manualFanSpeed);
      LogMessage(3, logBuffer, 0);
    }
    fanSpeedSet = 1;
    return;
  }
  
  // Get temperature readings
  minPicTemp = GetMinPicTemp();
  maxPicTemp = GetMaxPicTemp();
  maxChipTemp = GetMaxChipTemp();
  latestMinPicTemp = GetMinPicTemp();
  tempDifference = maxPicTemp - latestMinPicTemp;
  
  // Check for temperature fluctuation
  if (lastMinPicTemp != 0xff) {
    currentMinPicTempDifference = lastMinPicTemp - minPicTemp;
    if (currentMinPicTempDifference < 0) {
      currentMinPicTempDifference = -currentMinPicTempDifference;
    }
    if (currentMinPicTempDifference > 4) {
      lastDiffContinuousTime = timeSinceLastDiffIncrease + 1;
      if (lastDiffContinuousTime > 1) {
        lastDiffContinuousTime = 2;
      }
      tempIncreaseDetected = timeSinceLastDiffIncrease < 1;
      timeSinceLastDiffIncrease = lastDiffContinuousTime;
      goto EvaluateTempChange;
    }
  }
  tempIncreaseDetected = timeSinceLastDiffIncrease < 2;
  timeSinceLastDiffIncrease = timeSinceLastDiffIncrease - 1 & ~((int)(timeSinceLastDiffIncrease - 1) >> 0x1f);

EvaluateTempChange:
  tempIncreaseFlag = !tempIncreaseDetected;
  lastMinPicTemp = minPicTemp;
  
  // Temperature regulation logic
  if (maxPicTemp < 0x49) {
    // Evaluate the need for fan speed adjustment based on temperature difference and thresholds
    int absTempDiff = (tempDifference ^ (int)tempDifference >> 0x1f) - ((int)tempDifference >> 0x1f);
    bool shouldAdjustFan = CompareThresholdsForFanAdjustment(minPicTemp, absTempDiff, tempIncreaseFlag);
    
    if (shouldAdjustFan && (tempIncreaseFlag == 0)) {
      // Reset the fan speed set flag
      fanSpeedSet = tempIncreaseFlag;
      if (absTempDiff < 0x1c) {
        AdjustFanSpeedBasedOnTempDiff(absTempDiff);
      } else {
        IncreaseFanSpeedBasedOnTempDiff(maxPicTemp, absTempDiff);
      }
      ForceFanSpeed(adjustedFanSpeed); // Apply the new fan speed
      return;
    }
  }
  
  if (fanSpeedSet == 0) {
    // Log if debug level allows
    if (debugLevel > 4) {
      LogFanSpeedAdjustmentDetails(minPicTemp, maxPicTemp, tempDifference, maxChipTemp, timeSinceLastDiffIncrease);
    }
    // Set fan speed set flag
    fanSpeedSet = 1;
  }
  // Set fan speed to 100% by default
  ForceFanSpeed(100);
  return;
}
```