```c
/* Global variable renaming:
    DAT_0007f7a8 => g_pwmFan1Descriptor
    DAT_0007f7ac => g_previousFanSpeed
    DAT_00590404 => g_someDeviceStatusFlag
    DAT_00482a5c => g_otherDeviceStatusFlag
    DAT_0007eba0 => g_systemState
    DAT_0007eb9c => g_debugLevel
    ram0x000603f0 => g_someRAMAddressValue
    s_pwm_for_fan_init_error_000603dc => g_PWMInitErrorMessage
*/

/* Forward declarations */
int InitialisePWM(int initialValue, int range);
void SetPWMFrequency(int descriptor, int frequency);
void RecordFanSpeed(int speed);
void LogEvent(int logType, char *message, int someValue);

void UpdateFanSpeed(int newFanSpeed) {
    char logBuffer[2048]; // Previously: local_810 to uStack_7fa (inclusive), changed to a single buffer
    int *initErrorMessage = (int *)&g_PWMInitErrorMessage; // Mapped from 5 separate variables

    // If the PWM for fan 1 has not been opened, try to initialize it
    if (g_pwmFan1Descriptor == 0) {
        g_pwmFan1Descriptor = InitialisePWM(0, 100000);
    }

    // If opening the PWM for fan 1 has failed, log the error message if certain conditions are met
    if (g_pwmFan1Descriptor < 0) {
        if ( (g_someDeviceStatusFlag != 0) || (g_otherDeviceStatusFlag != 0) || (g_systemState > 2)) {
            memcpy(logBuffer, g_PWMInitErrorMessage, sizeof(g_PWMInitErrorMessage));
            int ramValueHigh = (int)g_someRAMAddressValue; // This may be a part of the error message
            logBuffer[sizeof(g_PWMInitErrorMessage)] = ramValueHigh & 0xFF; // Take low part of high value
            logBuffer[sizeof(g_PWMInitErrorMessage) + 1] = (ramValueHigh >> 8) & 0xFF; // Take high part of the high value
            LogEvent(3, logBuffer, 0);
            return;
        }
    } else {
        // If the new PWM value differs from the last one, update the fan speed
        if (newFanSpeed != g_previousFanSpeed) {
            if (g_debugLevel > 4) {
                // Log the change attempt if debug level allows
                snprintf(logBuffer, sizeof(logBuffer), "set pwm = %d", newFanSpeed);
                LogEvent(4, logBuffer, 0);
            }
            // Set the new PWM frequency
            SetPWMFrequency(g_pwmFan1Descriptor, newFanSpeed);
            // Record the fan speed change (e.g., for monitoring or statistics)
            RecordFanSpeed(newFanSpeed);
            // Update the stored previous fan speed
            g_previousFanSpeed = newFanSpeed;
        }
    }
}
```