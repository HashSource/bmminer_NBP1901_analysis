```c
void log_message(uint log_level, char *additional_message, undefined4 extra_variable)
{
  char current_char;
  FILE *log_file;
  size_t program_message_length;
  size_t additional_message_length;
  int is_tty;
  char *message_iterator;
  byte condition_value;

  // Calculate lengths of existing message and the additional message
  program_message_length = strlen(global_log_buffer);
  additional_message_length = strlen(additional_message);

  // Check if the total length exceeds the maximum buffer size
  if (MAX_BUFFER_SIZE < program_message_length + additional_message_length + 1) {
    if (is_logging_to_syslog == '\0') {
      // Check if stderr is associated with a terminal
      is_tty = fileno(stderr);
      is_tty = isatty(is_tty);
      if (is_tty == 0) {
        fputs(global_log_buffer, stderr);
        fflush(stderr);
      }
      // Check if logging to a file is enabled and the file is opened
      if ((is_logging_to_file != '\0') &&
         ((log_file_handle != (FILE *)0x0 ||
          (log_file_handle = fopen64(log_file_path + 0x20, log_file_path), log_file_handle != (FILE *)0x0))))
      {
        log_file = log_file_handle;
        program_message_length = strlen(global_log_prefix);
        fwrite(global_log_prefix, program_message_length, 1, log_file);
        fflush(log_file_handle);
      }
      // Initialize logger name if not done already
      if (logger_name == 0) {
        logger_name = initialize_logger("bmminer_miner");
      }
      // Log the message with the logger
      logger(log_level, "logging.c", 9, global_format_str, 10, 0xc3, 0x3c, "%s", global_log_buffer);
      // Check the condition for debug levels
      if (log_level == 3) {
        condition_value = 0;
      }
      else {
        condition_value = global_debug_flags & 1;
      }
      if (condition_value == 0) {
        log_to_file_function("", global_log_prefix, extra_variable);
      }
    }
    else {
      // Log to syslog
      syslog(log_level | LOG_PID, "%s", global_log_buffer);
      // Initialize logger name if not done already
      if (logger_name == 0) {
        logger_name = initialize_logger("bmminer_miner");
      }
      // Log the message with the logger
      logger(log_level, "logging.c", 9, global_format_str, 10, 0xa7, 0x3c, "%s", global_log_buffer);
    }
    // Clear the global log buffer
    global_log_buffer[0] = 0;
  }
  // Add the additional message to the global log prefix
  strcat(global_log_prefix, additional_message);
  message_iterator = global_log_prefix;

  // Iterate through the message looking for newline or carriage return characters
  do {
    current_char = *message_iterator;
    if (current_char == '\r' || current_char == '\n') {
      if (is_logging_to_syslog == '\0') {
        // Check if stderr is associated with a terminal
        is_tty = fileno(stderr);
        is_tty = isatty(is_tty);
        if (is_tty == 0) {
          fputs(global_log_prefix, stderr);
          fflush(stderr);
        }
        // Check if logging to a file is enabled and the file is opened
        if ((is_logging_to_file != '\0') &&
           ((log_file_handle != (FILE *)0x0 ||
            (log_file_handle = fopen64(log_file_path + 0x20, log_file_path), log_file_handle != (FILE *)0x0)))
        ) {
          log_file = log_file_handle;
          program_message_length = strlen(global_log_prefix);
          fwrite(global_log_prefix, program_message_length, 1, log_file);
          fflush(log_file_handle);
        }
        // Initialize logger name if not done already
        if (logger_name == 0) {
          logger_name = initialize_logger("bmminer_miner");
        }
        // Log the message with the logger
        logger(log_level, "logging.c", 9, global_format_str, 10, 0xe9, 0x3c, "%s", global_log_buffer);
        // Check the condition for debug levels
        if (log_level == 3) {
          condition_value = 0;
        }
        else {
          condition_value = global_debug_flags & 1;
        }
        if (condition_value == 0) {
          log_to_file_function("", global_log_prefix, extra_variable);
        }
      }
      else {
        // Log to syslog
        syslog(log_level | LOG_PID, "%s", global_log_prefix);
        // Initialize logger name if not done already
        if (logger_name == 0) {
          logger_name = initialize_logger("bmminer_miner");
        }
        // Log the message with the logger
        logger(log_level, "logging.c", 9, global_format_str, 10, 0xcd, 0x3c, "%s", global_log_buffer);
      }
      // Clear the global log buffer
      global_log_buffer[0] = 0;
      return;
    }
    message_iterator = message_iterator + 1;
  } while (current_char != '\0');
  return;
}
```

Please note that due to the nature of decompiled code, there may be inaccuracies in the type or size of certain elements, or assumptions made for symbol naming based on context clues. As such, symbol (variable and function) naming should be vetted with additional information for accuracy.