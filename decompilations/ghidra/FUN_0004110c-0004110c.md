```c
// Function prototype: Set fan speed for Antminer
// param_1: Fan type (1 for main, 2 for secondary)
// param_2: Fan speed percentage (0 to 100)
uint32_t SetFanSpeed(int fan_type, uint fan_speed_percentage) {
  uint32_t status_code;
  uint fan_control_value;
  char error_msg[2056]; // Buffer to store error message if any
  char error_msg_suffix; // Msg suffix buffer
  
  // If the fan type is 1 (main fan), set fan speed
  if (fan_type == 1) {
    if (fan_speed_percentage > 100) {
      fan_speed_percentage = 100; // Limit fan speed percentage to a maximum of 100
    }
    fan_control_value = 100 - fan_speed_percentage | (fan_speed_percentage << 16);
    SendFanControlCommand(0x13, fan_control_value); // Send control command to main fan
    SendFanControlCommand(0x17, fan_control_value); // Duplicate control command to another register (possibly for redundancy)
    return 0; // Success status code
  }
  // Handling unsupported fan types
  else if (fan_type == 2) {
    // Construct an error message stating unsupported fan type and log it
    snprintf(error_msg, sizeof(error_msg), "pwm type %d not supported\n", fan_type - 1);
    LogError(0, error_msg);
    status_code = 0; // Still return success status code
  }
  else {
    // Construct a general 'bad parameter' error message and log it for invalid fan types
    error_msg[0] = global_bad_param_prefix[0]; // Use predefined error message prefix from global variable
    error_msg[4] = global_bad_param_prefix[4]; // Copy the rest of the error message from global variable
    *((uint16_t*)&error_msg[8]) = (uint16_t)global_bad_param_code;
    error_msg_suffix = (char)((uint)global_bad_param_code >> 16);
    LogError(0, error_msg);
    status_code = 0xfffffffd; // Status code for bad parameter
  }
  return status_code; // Return status code
}

// Note: The functions SendFanControlCommand and LogError are not defined in this snippet,
//       those should be separate functions responsible for controlling the fan
//       and logging errors respectively.

// Note: There are global error message variables and code that are referenced here
//       like 'global_bad_param_prefix' and 'global_bad_param_code'. Their actual
//       values/types should be determined from their usage and declaration elsewhere
//       in the original codebase.
```

In the modified code, I've changed the function and variables names to be more descriptive, added comments to explain what different parts of the function are doing, and have made an assumption about the two missing functions `SendFanControlCommand` and `LogError` based on their usage in the code. These functions would handle the actual fan control command sending and error logging in the real codebase. Moreover, I've addressed global variables like 'global_bad_param_prefix' and 'global_bad_param_code' which look like predefined error messages or codes; their actual values would need to be determined from the rest of the codebase.