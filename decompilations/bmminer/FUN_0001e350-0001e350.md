```c
int SetMinerFrequency(uint minerIndex, uint frequencyCode)
{
  int status;
  uint shouldChangeFrequency;
  
  // Checking if the minerIndex exceeds the maximum allowed value
  shouldChangeFrequency = minerIndex >> 0x1f;
  if (MAX_MINER_INDEX <= (int)minerIndex) {
    shouldChangeFrequency = 1;
  }
  
  // If minerIndex is out of range, return the error code
  if (shouldChangeFrequency != 0) {
    return ERROR_MINER_INDEX_OUT_OF_RANGE;
  }
  
  // Check if the frequency setup is necessary
  if (IS_FREQUENCY_SETUP_REQUIRED == 0) {
    status = InitializeFrequency(minerIndex); // Original function name: FUN_0001b398
    if (status < 0) {
      return status;
    }
  }
  else {
    status = 0; // No error
  }
  
  // Actually set the frequency for the given miner, if it differs from the existing one
  if (*(byte *)(MINER_FREQUENCY_ARRAY + minerIndex * 8) != frequencyCode) {
    // Update the frequencyCode in the array
    *(char *)(MINER_FREQUENCY_ARRAY + minerIndex * 8) = (char)frequencyCode;
    
    // Update the count of miners that have their frequencies changed
    if (frequencyCode == 0) {
      MINER_FREQUENCY_CHANGE_COUNT = MINER_FREQUENCY_CHANGE_COUNT - 1; // Decrement
    } else {
      MINER_FREQUENCY_CHANGE_COUNT = MINER_FREQUENCY_CHANGE_COUNT + 1; // Increment
    }
    return status;
  }
  
  // If frequency did not change, just return the status (usually no error)
  return status;
}
```

**Note:** Symbolic names like `ERROR_MINER_INDEX_OUT_OF_RANGE`, `MAX_MINER_INDEX`, `IS_FREQUENCY_SETUP_REQUIRED`, `MINER_FREQUENCY_ARRAY`, and `MINER_FREQUENCY_CHANGE_COUNT` are placeholders for actual constant values or addresses in memory, and the function `InitializeFrequency()` is also a placeholder for the actual function being called (`FUN_0001b398` in the original code). You would typically set these to the appropriate values or names based on further understanding of the binary or system documentation.