```c
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 ReplaceEnvironmentVariablesInString(char *inputString, int maxBufferSize)
{
  size_t inputStringLength;
  char *percentSignPos;
  uint formattedStringSize;
  size_t remainingInputLength;
  char *destinationBuffer;
  int scanfResult;
  int *errorNumberPointer;
  int charsProcessed;
  undefined2 formatSpecifier;
  undefined shortFormatSpecifier;
  char formattedStringBuffer[4100];
  char envVariableBuffer[4104];
  
  inputStringLength = strlen(inputString);
  while( true ) {
    do {
      destinationBuffer = strchr(inputString, '%');
      inputString = destinationBuffer + 1;
      if (destinationBuffer == NULL) {
        return 0; // No more '%' found, return success
      }
      memset(&formatSpecifier, 0, 0x1001);
      memset(formattedStringBuffer, 0, 0x1001);
      memset(envVariableBuffer, 0, 0x1001);
      charsProcessed = 0;
      scanfResult = __isoc99_sscanf(inputString, "%[.0-9-]%n", (int)&formatSpecifier + 1, &charsProcessed);
      if (scanfResult == 1) {
        formatSpecifier = CONCAT11(formatSpecifier._1_1_, '%');
        inputString = destinationBuffer + charsProcessed + 1;
        *(undefined *)((int)&formatSpecifier + charsProcessed + 1) = 's';
      }
      else {
        charsProcessed = 0;
        formatSpecifier = hardcodedFormatSpecifier; // Placeholder, original value unknown
        shortFormatSpecifier = (undefined)(hardcodedFormatSpecifier >> 0x10);
      }
      scanfResult = __isoc99_sscanf(inputString, "E(%[^)])%n", envVariableBuffer, &charsProcessed);
    } while (scanfResult == 0);
    
    inputString = inputString + charsProcessed;
    if (inputString[-1] != ')') {
      LogError(2, "src/zc_util.c", 0x7c, "in string[%s] can\'t find match )", destinationBuffer);
      return -1; // Error: unmatched parenthesis
    }
    percentSignPos = getenv(envVariableBuffer);
    formattedStringSize = snprintf(formattedStringBuffer, 0x1001, destinationBuffer, percentSignPos);
    if (formattedStringSize > 0x1000) {
      errorNumberPointer = GetErrorNumberLocation();
      LogError(2, "src/zc_util.c", 0x83, "snprintf fail, errno[%d], evn_value_len[%d]", *errorNumberPointer, formattedStringSize);
      return -1; // Error: snprintf failed
    }
    inputStringLength = (inputStringLength - (inputString - destinationBuffer)) + formattedStringSize;
    if (maxBufferSize - 1 < inputStringLength) break; // Buffer overflow check
    remainingInputLength = strlen(inputString);
    memmove(destinationBuffer + formattedStringSize, inputString, remainingInputLength + 1);
    memcpy(destinationBuffer, formattedStringBuffer, formattedStringSize);
  }
  LogError(2, "src/zc_util.c", 0x89, "replace env_value[%s] cause overlap", formattedStringBuffer);
  return -1; // Error: buffer overflow
}
```
Please note that this pseudo code contains placeholders (like `hardcodedFormatSpecifier`) for values that are not provided in the original code snippet. Also, the function `LogError` and `GetErrorNumberLocation` are hypothetical names for logging and error manipulation because the original code snippet just uses placeholder names for those functions (`FUN_0005df98` and `__errno_location()`). The actual implementation must define these functions appropriately.