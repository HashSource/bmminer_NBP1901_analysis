```c
void setVoltageForAllChips(uint32_t voltageControlRegister, int chipSelectionMode)
{
  char voltagePrefix;
  int chipIndex;
  int totalChipCount;
  char localBuffer[5]; // Buffer to hold the voltage command prefix
  
  // Choose the command prefix based on the chip selection mode
  if (chipSelectionMode == 0) {
    localBuffer[0] = 0x04; // Prefix for all chips
  } else {
    localBuffer[0] = 0x44; // Prefix for a single chip
  }

  chipIndex = 0; // Start with the first chip
  while (true) {
    totalChipCount = getChipCount(); // Get the total number of chips
    if (totalChipCount <= chipIndex) break; // If all chips have been processed, exit the loop
    char voltageLevel = getVoltage(chipIndex); // Get the voltage level for the current chip
    char chipAddress = getChipAddress(); // Get the chip address (not based on the index)
	
    // Write the voltage value to the chip
    writeToChip(voltageControlRegister, voltageLevel * chipAddress, 9, 1, localBuffer);
    chipIndex = chipIndex + 1; // Move to the next chip
  }
  
  return;
}
```