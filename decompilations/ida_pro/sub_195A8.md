```c
int __fastcall SetVoltageBySteps(int voltageStep)
{
  int status; // r0
  char logBuffer[2064]; // [sp+8h] [bp-810h] BYREF

  if ( (unsigned int)GlobalLogLevel > 3 )
  {
    snprintf(logBuffer, 0x800u, "%s to %d.\n", "SetVoltageBySteps", voltageStep);
    LogMessage(3, logBuffer, 0);
  }
  if ( InitializeVoltageControl() < 0 )
  {
    if ( (unsigned int)GlobalLogLevel > 3 )
    {
      strcpy(logBuffer, "InitializeVoltageControl failed");
      LogMessage(3, logBuffer, 0);
    }
    return -1;
  }
  else
  {
    status = 0;
    CurrentVoltageStep = voltageStep;
    TargetVoltageStep = voltageStep;
  }
  return status;
}
```