```c
int __fastcall ValidatePowerVoltage(int targetVoltage)
{
  double measuredVoltage; // d0
  int powerVersion; // r5
  int result; // r6
  int sleepCounter; // r5
  double adjustedVoltage; // d7
  unsigned int checkCounter; // r5
  int stabilityCounter; // r5
  char *trend; // r3
  int stackBufferSize; // [sp+4h] [bp-83Ch]
  char logBuffer[2096]; // [sp+10h] [bp-830h] BYREF

  powerVersion = GetPowerVersion();
  if (globalLogLevel > 3)
  {
    snprintf(logBuffer, 0x800u, "power type version: 0x%04x\n", powerVersion);
    LogMessage(3, logBuffer, 0);
  }
  if (IsPowerVersionSupported((unsigned __int16)powerVersion))
  {
    if (globalLogLevel > 3)
    {
      strcpy(logBuffer, "Enter sleep to make sure power release finish.\n");
      LogMessage(3, logBuffer, 0);
    }
    PrepareForSleep();
    sleep(1u);
    InitializeI2CDevices();
    result = ConfigurePowerIC(targetVoltage);
    if (result < 0)
    {
      if (globalLogLevel > 3)
      {
        snprintf(logBuffer, 0x800u, "%s power iic error.\n", "power_init");
        LogMessage(3, logBuffer, 0);
      }
      return result;
    }
    FinalizeSleep();
    sleep(1u);
    if ((unsigned int)(powerVersion - 117) <= 3)
    {
      sleepCounter = 3;
      while (1)
      {
        sleep(1u);
        measuredVoltage = ReadFeedbackVoltage();
        if (measuredVoltage < 0.0)
          break;
        adjustedVoltage = measuredVoltage * 100.0;
        if (adjustedVoltage <= targetVoltage * 1.1 && adjustedVoltage >= targetVoltage * 0.9)
        {
          result = 0;
          goto LABEL_COMPLETE;
        }
        if (globalLogLevel > 3)
        {
          trend = adjustedVoltage - targetVoltage <= 0.0 ? "drop" : "rise";
          snprintf(logBuffer, 0x800u, "chain avg vol %s from %d to %.2f", trend, targetVoltage, stackBufferSize, adjustedVoltage);
          LogMessage(3, logBuffer, 0);
          if (globalLogLevel > 3)
          {
            strcpy(logBuffer, "power voltage can not meet the target");
            LogMessage(3, logBuffer, 0);
          }
        }
        if (!--sleepCounter)
        {
          result = -1;
          goto LABEL_COMPLETE;
        }
      }
      if (globalLogLevel > 3)
      {
        strcpy(logBuffer, "read_feedback_voltage failed!");
        LogMessage(3, logBuffer, 0);
      }
      result = -1;
      SendMessageToUI(9u, "power voltage read failed, pls check!");
LABEL_COMPLETE:
      checkCounter = 0;
      while (1)
      {
        ++checkCounter;
        if (!CheckPowerStatus())
          break;
        if (checkCounter == 5 * (checkCounter / 5) && globalLogLevel > 3)
        {
          strcpy(logBuffer, "bitmain_get_power_status failed!");
          LogMessage(3, logBuffer, checkCounter % 5);
        }
        sleep(3u);
        if (checkCounter == 20)
          return -1;
      }
      return result;
    }
    stabilityCounter = 3;
    while (1)
    {
      sleep(1u);
      measuredVoltage = ReadStartupVoltage();
      if (measuredVoltage >= targetVoltage * 0.75 / 100.0)
        break;
      if (globalLogLevel > 3)
      {
        strcpy(logBuffer, "power voltage can not meet the target");
        LogMessage(3, logBuffer, 0);
      }
      if (!--stabilityCounter)
        return -1;
    }
    return 0;
  }
  else
  {
    if (globalLogLevel <= 3)
      return -1;
    strcpy(logBuffer, "power type version error\n");
    LogMessage(3, logBuffer, 0);
    return -1;
  }
}
```